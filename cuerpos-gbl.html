<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Three.js Earth with Light</title>
	<style>
		body { margin: 0; overflow: hidden; }
		canvas { display: block; }
	</style>
</head>
<body>
	<script type="importmap">
		{
			"imports": {
				"three": "https://cdn.jsdelivr.net/gh/mrdoob/three.js@r158/build/three.module.js",
				"three/addons/": "https://cdn.jsdelivr.net/gh/mrdoob/three.js@r158/examples/jsm/"
			}
		}
	</script>

	<script type="module">
		// Importar módulos desde un CDN confiable
		import * as THREE from 'three';
		import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
		import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

		let scene, camera, renderer, controls, earthModel;

		init();

		function init() {
			// Crear el renderizador
			renderer = new THREE.WebGLRenderer({ antialias: true });
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);

			// Crear la escena
			scene = new THREE.Scene();

			// Configurar la cámara
			camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
			camera.position.set(0, 0, 10);

			// Añadir controles orbitales
			controls = new OrbitControls(camera, renderer.domElement);
			controls.update();

			// Añadir luz ambiental
			const ambientLight = new THREE.AmbientLight(0xffffff, 0.3); // Luz tenue general
			scene.add(ambientLight);

			// Añadir un punto de luz
			const pointLight = new THREE.PointLight(0xffffff, 1, 50); // Luz blanca
			pointLight.position.set(10, 10, 10); // Posicionar la luz
			scene.add(pointLight);

			// Añadir un ayudante de luz para visualizar la posición de la luz (opcional)
			const pointLightHelper = new THREE.PointLightHelper(pointLight);
			scene.add(pointLightHelper);

			// Cargar modelo GLB local
			loadEarthModel();

			// Manejar redimensionamiento
			window.addEventListener('resize', onWindowResize);

			// Iniciar animación
			animate();
		}

		function loadEarthModel() {
			const loader = new GLTFLoader();

			// Ruta local del modelo GLB
			loader.load(
				'./models/celestial_bodies/Earth_1_12756.glb', // Cambia esta ruta según tu estructura
				(gltf) => {
					earthModel = gltf.scene;

					// Ajustar escala, posición y rotación
					earthModel.scale.set(1, 1, 1);
					earthModel.rotation.y = Math.PI; // Rotación inicial
					scene.add(earthModel);
				},
				undefined,
				(error) => console.error('Error al cargar el modelo:', error)
			);
		}

		function onWindowResize() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			renderer.setSize(window.innerWidth, window.innerHeight);
		}

		function animate() {
			requestAnimationFrame(animate);

			// Rotar el modelo de la Tierra (si está cargado)
			if (earthModel) {
				earthModel.rotation.y += 0.01;
			}

			renderer.render(scene, camera);
		}
	</script>
</body>
</html>
